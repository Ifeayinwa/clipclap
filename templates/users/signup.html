{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load static %}  

{% block title %}Sign Up{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h3 class="text-center mb-0">Create Your Account</h3>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
                    {% csrf_token %}
                    
                    <div class="row">
                        <!-- Left Column -->
                        <div class="col-md-6">
                            <h5 class="text-muted mb-3">Basic Information</h5>
                            {{ form.username|as_crispy_field }}
                            {{ form.email|as_crispy_field }}
                            {{ form.first_name|as_crispy_field }}
                            {{ form.last_name|as_crispy_field }}
                            {{ form.password1|as_crispy_field }}
                            {{ form.password2|as_crispy_field }}
                        </div>
                        
                        <!-- Right Column -->
                        <div class="col-md-6">
                            <h5 class="text-muted mb-3">Profile Settings</h5>
                            
                            <!-- Profile Picture Upload -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Profile Picture</label>
                                <div class="text-center mb-2">
                                    <img id="profile-pic-preview" src="{% static 'images/default-profile.png' %}" 
                                         class="rounded-circle border" width="120" height="120" 
                                         style="object-fit: cover; border: 3px solid #dee2e6 !important;">
                                </div>
                                <input type="file" name="profile_pic" accept="image/*" 
                                       class="form-control" id="id_profile_pic"
                                       onchange="previewImage(this)">
                                <div class="form-text">Upload a profile picture (optional). Max 5MB.</div>
                            </div>
                            
                            <!-- User Type Selection -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Account Type</label>
                                <div class="card">
                                    <div class="card-body">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="radio" name="user_type" 
                                                   id="user_type_consumer" value="consumer" checked>
                                            <label class="form-check-label" for="user_type_consumer">
                                                <strong>Consumer</strong> - Watch and enjoy videos
                                            </label>
                                            <div class="form-text text-muted">Browse, like, and comment on videos</div>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="user_type" 
                                                   id="user_type_creator" value="creator">
                                            <label class="form-check-label" for="user_type_creator">
                                                <strong>Creator</strong> - Upload and share videos
                                            </label>
                                            <div class="form-text text-muted">Upload videos and build your audience</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-user-plus me-2"></i>Create Account
                        </button>
                    </div>
                </form>
                
                <div class="mt-4 text-center">
                    <p class="mb-0">Already have an account? 
                        <a href="{% url 'users:login' %}" class="fw-bold text-decoration-none">Sign In</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function previewImage(input) {
    const preview = document.getElementById('profile-pic-preview');
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.src = e.target.result;
        }
        reader.readAsDataURL(input.files[0]);
    }
}
</script>
{% endblock %}